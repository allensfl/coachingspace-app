import{r as x,j as e,D as ee,n as se,o as ae,p as te,q as ne,X as le,s as re,B as o,d as L,i as Z,H as ie,U as oe,a5 as ce,a6 as de,e as S,h as U,S as me,m as he,F as O,f as xe,g as ue,v as pe,k as ge}from"./index-BCVF1PLb.js";import{I as q}from"./input-CMYn3E83.js";import{B as K}from"./badge-EtFkFwpi.js";import{T as je,a as fe,b as A,c as F}from"./tabs-D-qa9ZUa.js";import{u as Ne}from"./index-Btm19AAi.js";import{L as T}from"./label-gCXM_mwv.js";import{S as H,a as M,b as R,c as V,d as z}from"./select-B5ckg96L.js";import{F as we,T as ve}from"./tag-CD2sxHpH.js";import{U as ye}from"./upload-cloud-Dj9vcIDN.js";import{U as X}from"./upload-DSGQNpdk.js";import{E as Ce}from"./eye-B95wPRoU.js";import{D as be}from"./download-DKg7zGZ5.js";import{T as J}from"./trash-2-Doau15tD.js";import"./index-CTsaMBSn.js";import"./floating-ui.react-dom-DMRTrF13.js";import"./check-C26bXOMj.js";const De=({isOpen:g,onClose:u,onUpload:j,coachees:v,categories:f})=>{const[n,c]=x.useState(null),[d,m]=x.useState("unassigned"),[l,N]=x.useState(""),[h,p]=x.useState([]),[i,s]=x.useState(""),[t,r]=x.useState(""),C=x.useCallback(a=>{a.length>0&&(c(a[0]),r(""))},[]),{getRootProps:b,getInputProps:k,isDragActive:w}=Ne({onDrop:C,accept:{"application/pdf":[".pdf"],"image/jpeg":[".jpeg",".jpg"],"image/png":[".png"],"application/msword":[".doc"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":[".docx"]},maxFiles:1}),y=a=>{(a.key==="Enter"||a.key===",")&&(a.preventDefault(),i.trim()&&!h.includes(i.trim())&&p([...h,i.trim()]),s(""))},W=a=>{p(h.filter(D=>D!==a))},B=(a,D=2)=>{if(a===0)return"0 Bytes";const P=1024,Y=D<0?0:D,_=["Bytes","KB","MB","GB","TB"],E=Math.floor(Math.log(a)/Math.log(P));return parseFloat((a/Math.pow(P,E)).toFixed(Y))+" "+_[E]},Q=()=>{if(!n||!l){r("Bitte wÃ¤hle eine Datei und eine Kategorie aus.");return}const a={name:n.name,type:l,size:B(n.size),format:n.type.split("/")[1].toUpperCase(),keywords:h};j(d==="unassigned"?"general":d,a),I()},I=()=>{c(null),m("unassigned"),N(""),p([]),s(""),r("")},$=()=>{I(),u()};return e.jsx(ee,{open:g,onOpenChange:$,children:e.jsxs(se,{className:"sm:max-w-[525px] glass-card",children:[e.jsxs(ae,{children:[e.jsx(te,{children:"Dokument hochladen"}),e.jsx(ne,{children:"FÃ¼ge ein neues Dokument hinzu. WÃ¤hle optional einen Coachee, um es zuzuordnen."})]}),e.jsxs("div",{className:"grid gap-6 py-4",children:[e.jsxs("div",{...b(),className:`p-6 border-2 border-dashed rounded-lg text-center cursor-pointer transition-colors
              ${w?"border-primary bg-primary/10":"border-slate-700 hover:border-primary"}`,children:[e.jsx("input",{...k()}),n?e.jsxs("div",{className:"flex items-center justify-center text-left text-sm",children:[e.jsx(we,{className:"h-10 w-10 mr-4 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:n.name}),e.jsx("p",{className:"text-slate-400",children:B(n.size)})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center gap-2",children:[e.jsx(ye,{className:"h-10 w-10 text-slate-400"}),e.jsx("p",{className:"font-semibold",children:"Datei hierher ziehen oder klicken"}),e.jsx("p",{className:"text-xs text-slate-500",children:"PDF, DOCX, PNG, JPG etc."})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"coachee",children:"Coachee (optional)"}),e.jsxs(H,{value:d,onValueChange:m,children:[e.jsx(M,{id:"coachee",children:e.jsx(R,{placeholder:"Allgemeines Dokument"})}),e.jsxs(V,{children:[e.jsx(z,{value:"unassigned",children:"Allgemeines Dokument"}),v.map(a=>e.jsxs(z,{value:a.id.toString(),children:[a.firstName," ",a.lastName]},a.id))]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"doc-type",children:"Kategorie"}),e.jsxs(H,{value:l,onValueChange:N,children:[e.jsx(M,{id:"doc-type",children:e.jsx(R,{placeholder:"Kategorie auswÃ¤hlen"})}),e.jsx(V,{children:f.map(a=>e.jsx(z,{value:a.id,children:a.name},a.id))})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"keywords",children:"Keywords"}),e.jsxs("div",{className:"flex items-center flex-wrap gap-2 p-2 border border-slate-700 rounded-md",children:[h.map(a=>e.jsxs(K,{variant:"secondary",children:[a,e.jsx("button",{onClick:()=>W(a),className:"ml-2 rounded-full hover:bg-slate-600",children:e.jsx(le,{className:"h-3 w-3"})})]},a)),e.jsx(q,{id:"keywords",placeholder:"Keywords hinzufÃ¼gen...",value:i,onChange:a=>s(a.target.value),onKeyDown:y,className:"flex-1 border-0 bg-transparent focus-visible:ring-0 focus-visible:ring-offset-0 p-0 h-auto"})]})]}),t&&e.jsx("p",{className:"text-sm text-red-500",children:t})]}),e.jsxs(re,{children:[e.jsx(o,{variant:"outline",onClick:$,children:"Abbrechen"}),e.jsx(o,{onClick:Q,children:"Hochladen & Speichern"})]})]})})},G=({documents:g,onAction:u,onUpload:j})=>{const{state:v}=L(),{coachees:f,settings:n}=v,{documentCategories:c}=n,[d,m]=x.useState(""),[l,N]=x.useState("all"),h=s=>c.find(t=>t.id===s)||{name:"Unkategorisiert",color:"bg-gray-500/20 text-gray-400 border-gray-500/30"},p=s=>{if(!s)return"Allgemein";const t=f.find(r=>r.id===s);return t?`${t.firstName} ${t.lastName}`:"Unbekannt"},i=g.filter(s=>{if(!s||!s.name)return!1;const t=s.coacheeId?p(s.coacheeId):"Allgemein",r=Array.isArray(s.keywords)?s.keywords.join(" "):"",C=s.name.toLowerCase().includes(d.toLowerCase())||t.toLowerCase().includes(d.toLowerCase())||r.toLowerCase().includes(d.toLowerCase()),b=l==="all"||s.type===l;return C&&b});return e.jsxs("div",{className:"space-y-6",children:[e.jsx(S,{className:"glass-card",children:e.jsx(U,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(me,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx(q,{placeholder:"Dokumente, Coachees oder Keywords suchen...",value:d,onChange:s=>m(s.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(o,{variant:l==="all"?"default":"outline",size:"sm",onClick:()=>N("all"),children:"Alle"}),c.map(s=>e.jsx(o,{variant:l===s.id?"default":"outline",size:"sm",onClick:()=>N(s.id),children:s.name},s.id))]})]})})}),e.jsx("div",{className:"space-y-4",children:i.map((s,t)=>e.jsx(he.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:t*.1},children:e.jsx(S,{className:"glass-card hover:bg-slate-800/50 transition-colors",children:e.jsx(U,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(O,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"font-semibold text-white text-lg",children:s.name}),e.jsx(K,{className:h(s.type).color,children:h(s.type).name})]}),e.jsxs("p",{className:"text-sm text-slate-400 mb-1",children:["Zugeordnet: ",p(s.coacheeId)]}),e.jsxs("p",{className:"text-sm text-slate-400",children:[s.format," â€¢ ",s.size," â€¢ Hochgeladen: ",new Date(s.uploadDate).toLocaleDateString("de-DE")]}),s.keywords&&s.keywords.length>0&&e.jsxs("div",{className:"flex items-center gap-2 mt-2 flex-wrap",children:[e.jsx(ve,{className:"h-4 w-4 text-slate-500"}),s.keywords.map(r=>e.jsx(K,{variant:"secondary",children:r},r))]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(o,{variant:"outline",size:"sm",onClick:()=>u("view",s),children:[e.jsx(Ce,{className:"mr-2 h-4 w-4"}),"Ansehen"]}),e.jsxs(o,{variant:"outline",size:"sm",onClick:()=>u("download",s),children:[e.jsx(be,{className:"mr-2 h-4 w-4"}),"Download"]}),e.jsx(o,{variant:"outline",size:"sm",onClick:()=>u("delete",s),className:"text-red-400 hover:text-red-300 hover:bg-red-500/10",children:e.jsx(J,{className:"h-4 w-4"})})]})]})})})},`${s.id}-${s.name}`))}),i.length===0&&e.jsx(S,{className:"glass-card",children:e.jsxs(U,{className:"p-12 text-center",children:[e.jsx(O,{className:"mx-auto h-12 w-12 text-slate-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Keine Dokumente gefunden"}),e.jsx("p",{className:"text-slate-400 mb-4",children:d||l!=="all"?"Versuche andere Suchbegriffe oder Filter.":"Lade dein erstes Dokument hoch, um zu beginnen."}),e.jsxs(o,{onClick:j,children:[e.jsx(X,{className:"mr-2 h-4 w-4"}),"Dokument hochladen"]})]})})]})},ke=()=>{const{state:g,actions:u}=L(),{settings:j}=g,{updateDocumentCategories:v}=u,{toast:f}=Z(),n=()=>{f({title:"ðŸš§ Funktion nicht implementiert",description:"Kann im nÃ¤chsten Prompt angefordert werden! ðŸš€"})};return e.jsxs(S,{className:"glass-card",children:[e.jsx(xe,{children:e.jsx(ue,{children:"Kategorien verwalten"})}),e.jsxs(U,{children:[e.jsx("div",{className:"space-y-3",children:j.documentCategories.map(c=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-800/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`h-4 w-4 rounded-full ${c.color.split(" ")[0]}`}),e.jsx("span",{className:"font-medium text-white",children:c.name})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{variant:"ghost",size:"icon",onClick:n,children:e.jsx(pe,{className:"h-4 w-4"})}),e.jsx(o,{variant:"ghost",size:"icon",onClick:n,children:e.jsx(J,{className:"h-4 w-4 text-destructive"})})]})]},c.id))}),e.jsxs(o,{onClick:n,className:"mt-6 w-full",children:[e.jsx(ge,{className:"mr-2 h-4 w-4"}),"Neue Kategorie"]})]})]})};function Re(){const{state:g,actions:u}=L(),{coachees:j,generalDocuments:v,settings:f}=g,{getAllCoacheeDocuments:n,addDocument:c}=u,[d,m]=x.useState(!1),{toast:l}=Z(),N=n(),h=(i,s)=>{c(i,s),l({title:"Dokument hochgeladen",description:`${s.name} wurde erfolgreich hinzugefÃ¼gt.`,className:"bg-green-600 text-white"}),m(!1)},p=(i,s)=>{if(i==="download"&&s.fileContent){const t=atob(s.fileContent.split(",")[1]),r=new Array(t.length);for(let y=0;y<t.length;y++)r[y]=t.charCodeAt(y);const C=new Uint8Array(r),b=new Blob([C],{type:s.format}),k=URL.createObjectURL(b),w=document.createElement("a");w.href=k,w.download=s.name,document.body.appendChild(w),w.click(),document.body.removeChild(w),URL.revokeObjectURL(k),l({title:"Download gestartet",description:`${s.name} wird heruntergeladen.`})}else l({title:"ðŸš§ Funktion nicht implementiert",description:`Aktion "${i}" fÃ¼r ${s.name} kann im nÃ¤chsten Prompt angefordert werden! ðŸš€`})};return e.jsxs(e.Fragment,{children:[e.jsxs(ie,{children:[e.jsx("title",{children:"Dokumente - Coachingspace"}),e.jsx("meta",{name:"description",content:"Zentrale Dokumentenverwaltung fÃ¼r alle Coaching-Unterlagen, VertrÃ¤ge und Assessments."})]}),e.jsx(De,{isOpen:d,onClose:()=>m(!1),onUpload:h,coachees:j,categories:f.documentCategories}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Dokumente"}),e.jsx("p",{className:"text-slate-400",children:"Zentrale Dokumentenverwaltung"})]}),e.jsxs(o,{onClick:()=>m(!0),className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(X,{className:"mr-2 h-4 w-4"}),"Dokument hochladen"]})]}),e.jsxs(je,{defaultValue:"coachee-docs",className:"w-full",children:[e.jsxs(fe,{className:"grid w-full grid-cols-3",children:[e.jsxs(A,{value:"coachee-docs",children:[e.jsx(oe,{className:"mr-2 h-4 w-4"}),"Coachee-Dokumente"]}),e.jsxs(A,{value:"general-docs",children:[e.jsx(ce,{className:"mr-2 h-4 w-4"}),"Allgemeine Dokumente"]}),e.jsxs(A,{value:"categories",children:[e.jsx(de,{className:"mr-2 h-4 w-4"}),"Kategorien verwalten"]})]}),e.jsx(F,{value:"coachee-docs",className:"mt-6",children:e.jsx(G,{documents:N,onAction:p,onUpload:()=>m(!0)})}),e.jsx(F,{value:"general-docs",className:"mt-6",children:e.jsx(G,{documents:v,onAction:p,onUpload:()=>m(!0)})}),e.jsx(F,{value:"categories",className:"mt-6",children:e.jsx(ke,{})})]})]})]})}export{Re as default};
